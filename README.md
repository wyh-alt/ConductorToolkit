# 音频处理工具集

这是一个整合了音频对齐裁剪和导唱批量命名两个功能的综合工具。

## 功能介绍

本工具包含两个主要功能模块：

1. **音频对齐裁剪** - 从音频文件夹A中的文件获取时长，并将音频文件夹B中的文件裁剪为相同的时长。
   - 支持自动匹配文件ID
   - 支持自定义输出格式
   - 可设置采样率、声道数、位深等参数
   - 实时显示处理进度和结果

2. **导唱批量命名** - 根据Excel表格中的映射关系，将FLAC文件重命名为指定名称。
   - 支持按创建时间排序文件
   - 自动检测文件数量与表格行数是否匹配
   - 详细的处理日志

## 安装

本程序是一个绿色软件，无需安装，直接运行即可。

### 从源码安装运行

如果您想从源码运行，请按照以下步骤操作：

1. 确保已安装Python 3.7及以上版本
2. 安装依赖库：
   ```
   pip install -r requirements.txt
   ```
3. 运行主程序：
   ```
   python integrated_app.py
   ```

### 打包为可执行文件

可以使用build_integrated.py脚本将程序打包为可执行文件：

```
python build_integrated.py
```

打包后的文件位于dist/音频处理工具集/目录下。

## 使用方法

### 音频对齐裁剪功能

1. 选择"音频对齐裁剪"标签页
2. 设置三个文件夹：
   - 音频文件夹A（参考长度）：包含用于参考长度的音频文件
   - 音频文件夹B（需裁剪）：包含需要裁剪的音频文件
   - 输出文件夹：处理后的文件将保存在此
3. 设置输出文件命名格式（可使用变量：{original_name}、{file_id}、{extension}、{timestamp}）
4. 选择音频格式设置（WAV格式、采样率、声道数、位深等）
5. 点击"开始处理"按钮
6. 在结果表格中查看处理结果

### 导唱批量命名功能

1. 选择"导唱批量命名"标签页
2. 设置三个路径：
   - Excel表格路径：包含"伴奏ID"和"AI干声文件名"列的Excel文件
   - FLAC文件夹路径：包含需要重命名的FLAC文件
   - 输出文件夹路径：重命名后的文件将保存在此
3. 点击"开始重命名"按钮
4. 在日志区域查看处理进度

## 注意事项

1. Excel表格必须包含"伴奏ID"和"AI干声文件名"两列
2. FLAC文件会按创建时间从早到晚排序，并按顺序与Excel表格中的行对应
3. 程序支持文件拖放功能，可以直接将文件夹或Excel文件拖入相应的输入框

## 常见问题

**Q: 为什么有些文件无法匹配？**
A: 系统根据文件名中的ID部分进行匹配，如果文件命名不规范，可能导致无法识别或错误匹配。

**Q: 为什么处理速度较慢？**
A: 音频处理需要大量计算资源，特别是高采样率和长音频文件。

**Q: 如何解决"文件已存在"的警告？**
A: 您可以在开始处理前清空输出文件夹，或者手动删除已存在的文件。

## 开发信息

- 开发语言：Python
- 图形界面：PyQt5
- 音频处理：librosa, pydub
- 数据处理：pandas

## 版权信息

本软件为内部使用工具，版权所有，未经授权不得用于商业目的。 